{"version":3,"file":"single-spa.js","sources":["../../src/applications/apps.helper.js","../../src/start.js","../../src/lifecycles/helper.js","../../src/applications/timeout.js","../../src/lifecycles/load.js","../../src/lifecycles/unmount.js","../../src/lifecycles/mount.js","../../src/lifecycles/bootstrap.js","../../src/navigation/hijackLocation.js","../../src/navigation/invoke.js","../../src/applications/apps.js"],"sourcesContent":["'use strict'\r\n/**\r\n * 未加载\r\n */\r\nexport const NO_LOADED = 'NO_LOADED'\r\n/**\r\n * 加载源代码\r\n */\r\nexport const LOAD_SOURCE_CODE = 'LOAD_SOURCE_CODE'\r\n\r\n/**\r\n * 未启动\r\n */\r\nexport const NOT_BOOTSTRAPPED = 'NOT_BOOTSTRAPPED'\r\n/**\r\n * 启动中\r\n */\r\nexport const BOOTSTRAPPING = 'BOOTSTRAPPING'\r\n/**\r\n * 还没有挂载\r\n */\r\nexport const NOT_MOUNTED = 'NOT_MOUNTED'\r\n/**\r\n * 挂载中\r\n */\r\nexport const MOUNTING = 'MOUNTING'\r\n/**\r\n * 挂载结束\r\n */\r\nexport const MOUNTED = 'MOUNTED'\r\n/**\r\n * 卸载中\r\n */\r\nexport const UNMOUNTING = 'UNMOUNTING'\r\n/**\r\n * 更新中\r\n */\r\nexport const UPDATING = 'UPDATING'\r\n/**\r\n * 未跳过\r\n */\r\nexport const NOT_SKIP = 'NOT_SKIP'\r\n/**\r\n * 执行错误\r\n */\r\nexport const SKIP_BECAUSE_BROKEN = 'SKIP_BECAUSE_BROKEN'\r\n/**\r\n * 加载错误\r\n */\r\nexport const LOAD_ERROR = \"LOAD_ERROR\"\r\n\r\n// 没有错误 \r\nexport function noSkip (app) {\r\n  return app.status !== SKIP_BECAUSE_BROKEN\r\n}\r\n// 没有致命的加载错误\r\nexport function noLoadError (app) {\r\n  return app.status !== LOAD_ERROR\r\n\r\n}\r\n\r\n// 运营中\r\nexport function isActive (app) {\r\n  return app.status === MOUNTED;\r\n}\r\n// 非运行中\r\nexport function isntActive (app) {\r\n  return !isActive(app)\r\n}\r\n// 已经加载了\r\nexport function isLoaded (app) {\r\n  return app.status !== NO_LOADED && app.status !== LOAD_ERROR && app.status !== LOAD_SOURCE_CODE;\r\n}\r\n\r\n// 未加载\r\nexport function isntLoaded (app) {\r\n  return !isLoaded(app)\r\n}\r\n// 应该被执行\r\nexport function shouldBeActivity (app) {\r\n  try {\r\n    return app.activityWhen(window.location)\r\n  } catch (e) {\r\n    app.status === SKIP_BECAUSE_BROKEN\r\n    console.log(\"ERROR\", e);\r\n\r\n  }\r\n}\r\n// 不应该被执行\r\nexport function shouldntBeActive (app) {\r\n  try {\r\n    return !app.activityWhen(window.location);\r\n  } catch (e) {\r\n    app.status = SKIP_BECAUSE_BROKEN;\r\n    throw e;\r\n  }\r\n}\r\n","import { invoke } from \"./navigation/invoke\";\r\n\r\n\"use strict\";\r\nlet started = false\r\nexport function start () {\r\n  if (started) {\r\n    return Promise.resolve()\r\n  }\r\n  started = true\r\n  return invoke()\r\n}\r\nexport function isStarted () {\r\n  return started\r\n}","\"use strict\"\r\n// 判断是不是一个promise\r\nexport function lookLikePromise (promise) {\r\n  // 判断是不是Promise实例\r\n  if (promise instanceof Promise) {\r\n    return true\r\n  }\r\n  // 判断自定义Pormise\r\n  return typeof promise === 'object' && typeof promise.then() === 'fucntion' && typeof promise.catch === 'function'\r\n\r\n}\r\n// 处理生命周期数组\r\nexport function flattenLifecyclesArray (lifecycle, description) {\r\n  if (!Array.isArray(lifecycle)) {\r\n    lifecycle = [lifecycle]\r\n  }\r\n  if (!lifecycle.length) {\r\n    lifecycle = [() => Promise.resolve()]\r\n  }\r\n\r\n  // 对生命周期函数按顺序执行\r\n  return props => new Promise((resolve, reject) => {\r\n    waitForFunction(0)\r\n    function waitForFunction (index) {\r\n      let fn = lifecycle[index](props)\r\n      // 如果不是一个promise直接返回错误信息\r\n      if (!lookLikePromise(fn)) {\r\n        reject(new Error(`${description}`))\r\n      } else {\r\n        // 处理生命周期函数\r\n        fn.then(() => {\r\n          if (index === lifecycle.length - 1) {\r\n            resolve();\r\n          } else {\r\n            waitForFunction(++index)\r\n          }\r\n        }).catch((e) => {\r\n          reject(e);\r\n        })\r\n      }\r\n    }\r\n  })\r\n\r\n}\r\nexport function getProps (app) {\r\n  return {\r\n    name: app.name,\r\n    ...app.customProps\r\n  }\r\n}","\r\n'use strict'\r\nconst TIMEOUTS = {\r\n  bootstrap: {\r\n    milliseconds: 3000,\r\n    rejectWhenIimeout: false\r\n  },\r\n  mount: {\r\n    milliseconds: 3000,\r\n    rejectWhenIimeout: false\r\n  },\r\n  unmount: {\r\n    milliseconds: 3000,\r\n    rejectWhenIimeout: false\r\n  }\r\n}\r\n\r\nexport function reasonableTime (lifecyclePromise, description, timeout) {\r\n  return new Promise((resolve, reject) => {\r\n    let finished = false\r\n    lifecyclePromise.then((data) => {\r\n      finished = true\r\n      resolve(data)\r\n    }).catch(e => {\r\n      finished = true\r\n      reject(e)\r\n    })\r\n    setTimeout(() => {\r\n      if (finished) {\r\n        return\r\n      }\r\n      if (timeout.rejectWhenIimeout) {\r\n        reject(`${description}`)\r\n      } else {\r\n        console.log(\"timeout but waiting\");\r\n\r\n      }\r\n    }, timeout.milliseconds)\r\n  })\r\n}\r\n\r\n\r\nexport function ensureTimeout (timeouts = {}) {\r\n  return {\r\n    ...TIMEOUTS,\r\n    ...timeouts\r\n  }\r\n  // return Object.assign({}, TIMEOUTS, timeouts)\r\n}","'use strict'\r\nimport { NO_LOADED, LOAD_SOURCE_CODE, SKIP_BECAUSE_BROKEN, NOT_BOOTSTRAPPED, LOAD_ERROR } from '../applications/apps.helper'\r\nimport { lookLikePromise, flattenLifecyclesArray, getProps } from './helper'\r\nimport { ensureTimeout } from '../applications/timeout'\r\n\r\nexport function toloadPromise (app) {\r\n  if (app.status !== NO_LOADED) {\r\n    return Promise.resolve(app)\r\n  }\r\n  // 加载app代码\r\n  app.status = LOAD_SOURCE_CODE\r\n  // 加载程序\r\n  let loadPromise = app.loadFunction(getProps(app))\r\n  // 判断返回的是不是一个promise\r\n  if (!lookLikePromise(loadPromise)) {\r\n    app.status = SKIP_BECAUSE_BROKEN\r\n    return Promise.reject(new Error(\"loadPromise must return a promise or thenable object\"));\r\n  }\r\n  return loadPromise.then(appConfig => {\r\n    // appCofig必须是一个对象，包含app的生命周期等等信息\r\n    if (typeof appConfig !== 'object') {\r\n      throw new Error(\"appConfig must be a object\")\r\n    }\r\n    // app生命周期：bootstrap，mount，unmount\r\n    let errors = []\r\n    let temp = ['bootstrap', 'mount', 'unmount']\r\n    temp.forEach(lifecycle => {\r\n      if (!appConfig[lifecycle]) {\r\n        errors.push('lifecycle:' + lifecycle + 'must be exists')\r\n      }\r\n    })\r\n    if (errors.length > 0) {\r\n      // 状态不合法\r\n      app.status = SKIP_BECAUSE_BROKEN\r\n      console.log(\"load.js\", errors);\r\n      return\r\n    }\r\n    app.status = NOT_BOOTSTRAPPED\r\n    // 初始化当前要启用app的核心方法\r\n    app.bootstrap = flattenLifecyclesArray(appConfig.bootstrap, `app:${app.name} bootstrapping`)\r\n    app.mount = flattenLifecyclesArray(appConfig.mount, `app:${app.name} mounting`)\r\n    app.unmount = flattenLifecyclesArray(appConfig.unmount, `app:${app.name} unmounting`)\r\n    app.timeouts = ensureTimeout(appConfig.timeouts)\r\n    // 加载就绪，返回app\r\n    return app\r\n  }).catch(e => {\r\n    app.status = LOAD_ERROR\r\n    console.log(\"App,加载失败\", e);\r\n\r\n  })\r\n}","import { MOUNTED, NOT_MOUNTED, SKIP_BECAUSE_BROKEN } from \"../applications/apps.helper\";\r\nimport { reasonableTime } from \"../applications/timeout\";\r\nimport { getProps } from \"./helper\";\r\n\r\n'use strict'\r\nexport function toUnMountPromise (app) {\r\n  if (app.status != MOUNTED) {\r\n    return Promise.resolve(app)\r\n  }\r\n  return reasonableTime(app.unmount(getProps(app)),\r\n    `app:${app.name}unmounting`,\r\n    app.timeouts.unmount).then(() => {\r\n      app.status = NOT_MOUNTED;\r\n      return app\r\n    }).catch(e => {\r\n      app.status = SKIP_BECAUSE_BROKEN\r\n      console.log(e);\r\n      return app\r\n    })\r\n}","import { NOT_MOUNTED, MOUNTING, MOUNTED } from \"../applications/apps.helper\";\r\nimport { reasonableTime } from \"../applications/timeout\";\r\nimport { getProps } from \"./helper\";\r\nimport { toUnMountPromise } from \"./unmount\";\r\n\r\n\"use strict\"\r\nexport function toMountPromise (app) {\r\n  if (app.status !== NOT_MOUNTED) {\r\n    return Promise.resolve(app)\r\n  }\r\n  app.status = MOUNTING\r\n  return reasonableTime(app.mount(getProps(app)),\r\n    `app:${app.name} mounting`,\r\n    app.timeouts.mount\r\n  ).then(() => {\r\n    app.status = MOUNTED\r\n    return app\r\n  }).catch(e => {\r\n    app.status = MOUNTED\r\n    // 如果挂载失败，就立马卸载\r\n    return toUnMountPromise(app)\r\n  })\r\n}","import { NOT_BOOTSTRAPPED, BOOTSTRAPPING, NOT_MOUNTED, SKIP_BECAUSE_BROKEN } from \"../applications/apps.helper\";\r\nimport { reasonableTime } from \"../applications/timeout\";\r\nimport { getProps } from \"./helper\";\r\n\r\n\"use strict\"\r\nexport function toBootStrapPromise (app) {\r\n  if (app.status !== NOT_BOOTSTRAPPED) {\r\n    return Promise.resolve(app)\r\n  }\r\n  app.status = BOOTSTRAPPING\r\n  return reasonableTime(app.bootstrap(getProps(app)),\r\n    `app:${app.name} bootstrapping`,\r\n    app.timeouts.bootstrap).then(() => {\r\n      app.status = NOT_MOUNTED\r\n      return app\r\n    }).catch(e => {\r\n      app.status = SKIP_BECAUSE_BROKEN\r\n      console.log(e);\r\n      return app\r\n\r\n    })\r\n}","import { invoke } from \"./invoke\";\r\nconst HIJACK_EVENT_NAME = /^(hashchange|popstate)$/i\r\nconst EVENT_POOL = {\r\n  hashchange: [],\r\n  popstate: []\r\n}\r\n'use strict'\r\n// 路由拦截\r\nfunction reroute () {\r\n  invoke([], arguments)\r\n}\r\n// 确保框架路由优先执行\r\nwindow.addEventListener(\"hashchange\", e => reroute(e))\r\nwindow.addEventListener(\"popstate\", reroute)\r\n\r\nconst originalAddEventListenner = window.addEventListener\r\nconst originalRemoveEventListenner = window.removeEventListener\r\n\r\n// 方法重写\r\nwindow.addEventListener = function (eventName, handle) {\r\n  if (eventName && HIJACK_EVENT_NAME.test(eventName)) {\r\n    EVENT_POOL[eventName].indexOf(handle) === -1 && EVENT_POOL[eventName].push(handle)\r\n  } else {\r\n    originalAddEventListenner.apply(this, arguments)\r\n  }\r\n\r\n}\r\nwindow.removeEventListener = function (eventName, handle) {\r\n  if (eventName && HIJACK_EVENT_NAME.test(eventName)) {\r\n    let events = EVENT_POOL[eventName]\r\n    events.indexOf(handle) > -1 && (EVENT_POOL[eventName] = events.filter(fn => fn != handle))\r\n  } else {\r\n    originalRemoveEventListenner.apply(window, arguments)\r\n  }\r\n}\r\n\r\nconst originalPushState = window.history.pushState\r\nconst originalReplaceState = window.history.replaceState\r\n\r\n\r\n// 重写history\r\nfunction mockPopStateEvent (state) {\r\n  return new PopStateEvent('popstate', state)\r\n}\r\n\r\nwindow.history.pushState = function (state, title, url) {\r\n  let res = originalPushState.apply(this, arguments)\r\n  reroute(mockPopStateEvent(res))\r\n  return res\r\n}\r\nwindow.history.replaceState = function (state, title, url) {\r\n  let res = originalReplaceState.apply(this, arguments)\r\n  reroute(mockPopStateEvent(res))\r\n  return res\r\n}\r\n\r\nexport function callCapturedEvents (eventsArgs) {\r\n  if (!eventsArgs) {\r\n    return\r\n  }\r\n  if (!Array.isArray(eventsArgs)) {\r\n    eventsArgs = [eventsArgs]\r\n  }\r\n\r\n  let name = eventsArgs[0].type\r\n  if (!EVENT_POOL[name]) {\r\n    return\r\n  }\r\n  EVENT_POOL.forEach(el => {\r\n\r\n  });\r\n}","\"use strict\"\r\nimport { isStarted } from '../start'\r\nimport { getAppsToload, getAppsToUnmount, getAppsToMount, getMoutedApps } from '../applications/apps'\r\nimport { toloadPromise } from '../lifecycles/load'\r\nimport { toUnMountPromise } from '../lifecycles/unmount'\r\nimport { toMountPromise } from '../lifecycles/mount'\r\nimport { toBootStrapPromise } from '../lifecycles/bootstrap'\r\nimport { callCapturedEvents } from './hijackLocation'\r\nlet appChangesUnderway = false\r\nlet changeQueue = []\r\nexport function invoke (pendings = [], eventArgs) {\r\n  if (appChangesUnderway) {\r\n    return new Promise((resolve, reject) => {\r\n      changeQueue.push(\r\n        {\r\n          success: resolve,\r\n          failure: reject,\r\n          eventArgs\r\n        }\r\n      )\r\n    })\r\n  }\r\n  appChangesUnderway = true\r\n  if (isStarted()) {\r\n    // app已经启动\r\n    return performAppchanges()\r\n  }\r\n  // 预加载\r\n  loadApps()\r\n\r\n  function loadApps () {\r\n    // 获取需要加载的app信息\r\n    return Promise.all(getAppsToload().map(toloadPromise)).then((apps) => {\r\n      callAllCaptureEvents()\r\n      console.log(\"APP\", apps)\r\n      // 返回执行结束\r\n      return finish()\r\n    }).catch(e => {\r\n      callAllCaptureEvents()\r\n      console.log(e);\r\n\r\n    })\r\n  }\r\n  function performAppchanges () {\r\n    //切换路由时：先卸载原有app，在加载目标app，挂载目标app\r\n    //1.卸载unmount\r\n    let unmountPromises = getAppsToUnmount().map(toUnMountPromise)\r\n    unmountPromises = Promise.all(unmountPromises)\r\n    //2.加载load\r\n    let loadApps = getAppsToload()\r\n    let loadPromises = loadApps.map(app => {\r\n      return toloadPromise(app).then(app => toBootStrapPromise(app)).then(() => unmountPromises).then(toMountPromise(app))\r\n    })\r\n    //3.挂载mounted \r\n    let mountApps = getAppsToMount()\r\n    // 去重\r\n\r\n    mountApps = mountApps.filter(app => loadApps.indexOf(app) === -1)\r\n    let mountPromises = mountApps.map(app => {\r\n      return toBootStrapPromise(app).then(() => unmountPromises).then(() => toMountPromise(app));\r\n    })\r\n\r\n    // 没有错误之后自取挂载\r\n    return unmountPromises.then(() => {\r\n      callAllCaptureEvents()\r\n      let promiseAll = loadPromises.concat(mountPromises)\r\n      return Promise.all(promiseAll).then(() => {\r\n        return finish()\r\n      }, e => {\r\n        pendings.forEach(item => item.failure(e))\r\n        throw e\r\n      })\r\n    }, e => {\r\n      callAllCaptureEvents()\r\n      console.log(e)\r\n    })\r\n  }\r\n  function finish () {\r\n    let returnVal = getMoutedApps()\r\n    if (pendings.length) {\r\n      // 当前被挂载的app\r\n      pendings.forEach(item => item.success(returnVal));\r\n    }\r\n    appChangesUnderway = false\r\n    if (changeQueue.length) {\r\n      let backup = changeQueue\r\n      changeQueue = []\r\n      invoke(backup)\r\n    }\r\n    // 返回被挂载的app\r\n    return returnVal\r\n  }\r\n  function callAllCaptureEvents () {\r\n    // eventQueue.length>0路由确实发生变化了\r\n    pendings && pendings.length && pendings.filter(item => {\r\n      return !!item.eventArgs\r\n    }).forEach(e => {\r\n      callCapturedEvents(e)\r\n    })\r\n\r\n    eventArgs && callCapturedEvents(eventArgs)\r\n  }\r\n}\r\n","\r\n'use strict'\r\nimport { NO_LOADED, noSkip, isLoaded, isntActive, isActive, shouldntBeActive, noLoadError, isntLoaded, shouldBeActivity } from './apps.helper'\r\nimport { invoke } from '../navigation/invoke'\r\n/**\r\n * \r\n * @param {要注册的app的名称} appName \r\n * @param {Function<Promise>||Object，app异步加载函数或者app内容} loadFunction \r\n * @param {Function<Boolean> 触发时机} activityWhen \r\n * @param {Object 自定义配置} customProps \r\n * return Promise\r\n */\r\n\r\nconst apps = []\r\n// 注册小程序\r\nexport function registerApplication (appName, loadFunction, activityWhen, customProps = {}) {\r\n  if (!appName || typeof appName !== 'string') {\r\n    throw new Error(\"appName must be a non-empty string\")\r\n  }\r\n  if (!loadFunction) {\r\n    throw new Error(\"loadFunction must be a Function or Object\")\r\n  }\r\n  if (typeof loadFunction !== 'function') {\r\n    loadFunction = () => Promise.resolve(loadFunction)\r\n  }\r\n  if (typeof activityWhen !== 'function') {\r\n    throw new Error(\"activityWhen must be a function\")\r\n  }\r\n  apps.push({\r\n    name: appName,\r\n    loadFunction,\r\n    activityWhen,\r\n    customProps,\r\n    status: NO_LOADED\r\n  })\r\n  invoke()\r\n}\r\n// 加载app\r\nexport function getAppsToload () {\r\n  return apps.filter(noSkip).filter(noLoadError).filter(isntLoaded).filter(shouldBeActivity)\r\n}\r\n// 卸载app\r\nexport function getAppsToUnmount () {\r\n  return apps.filter(noSkip).filter(isActive).filter(shouldntBeActive)\r\n}\r\n// 挂载app\r\nexport function getAppsToMount () {\r\n  return apps.filter(noSkip).filter(isLoaded).filter(isntActive).filter(shouldBeActivity)\r\n}\r\n// 获取当前已经挂载的App\r\nexport function getMoutedApps () {\r\n  return apps.filter(app => isActive(app))\r\n}"],"names":["NO_LOADED","LOAD_SOURCE_CODE","NOT_BOOTSTRAPPED","BOOTSTRAPPING","NOT_MOUNTED","MOUNTING","MOUNTED","SKIP_BECAUSE_BROKEN","LOAD_ERROR","noSkip","app","status","noLoadError","isActive","isntActive","isLoaded","isntLoaded","shouldBeActivity","activityWhen","window","location","e","console","log","shouldntBeActive","started","start","Promise","resolve","invoke","isStarted","lookLikePromise","promise","then","catch","flattenLifecyclesArray","lifecycle","description","Array","isArray","length","props","reject","waitForFunction","index","fn","Error","getProps","name","customProps","TIMEOUTS","bootstrap","milliseconds","rejectWhenIimeout","mount","unmount","reasonableTime","lifecyclePromise","timeout","finished","data","setTimeout","ensureTimeout","timeouts","toloadPromise","loadPromise","loadFunction","appConfig","errors","temp","forEach","push","toUnMountPromise","toMountPromise","toBootStrapPromise","HIJACK_EVENT_NAME","EVENT_POOL","hashchange","popstate","reroute","arguments","addEventListener","originalAddEventListenner","originalRemoveEventListenner","removeEventListener","eventName","handle","test","indexOf","apply","events","filter","originalPushState","history","pushState","originalReplaceState","replaceState","mockPopStateEvent","state","PopStateEvent","title","url","res","callCapturedEvents","eventsArgs","type","el","appChangesUnderway","changeQueue","pendings","eventArgs","success","failure","performAppchanges","loadApps","all","getAppsToload","map","apps","callAllCaptureEvents","finish","unmountPromises","getAppsToUnmount","loadPromises","mountApps","getAppsToMount","mountPromises","promiseAll","concat","item","returnVal","getMoutedApps","backup","registerApplication","appName"],"mappings":"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"}